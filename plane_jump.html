<!DOCTYPE html>
<html>
    <head>
        <script src="//cdn.jsdelivr.net/npm/phaser@3.24.1/dist/phaser.min.js"></script>
    </head>
    <body>
        <div id="game"></div>
        <script>
// example from https://www.thepolyglotdeveloper.com/2020/09/include-touch-cursor-gesture-events-phaser-game/
/*
            const phaserConfig = {
                type: Phaser.AUTO,
                parent: "game",
                width: 1280,
                height: 720,
                backgroundColor: "#5DACD8",
                scene: {
                    init: initScene,
                    preload: preloadScene,
                    create: createScene,
                    update: updateScene
                }
            }; 
  */          

  //from  https://rexrainbow.github.io/phaser3-rex-notes/docs/site/game/#configuration
 // something added

            const phaserConfig = {
                type: Phaser.AUTO,
                parent: 'game',
                // 750x1334
                // 2560Ã—1440
                width: 600,
                height: 800,
                //width: 1440,
                //height: 2560,
                scale: {
                    mode: Phaser.Scale.FIT,
                    autoCenter: Phaser.Scale.CENTER_BOTH
                },
                dom: {
                    createContainer: false,
                },
                scene: 'scene_01',
                backgroundColor: 0x333333,
                scene: {
                    init: initScene,
                    preload: preloadScene,
                    create: createScene,
                    update: updateScene
                }            
            }

            const game = new Phaser.Game(phaserConfig);

            //var game = new Phaser.Game(config);


            var isClicking = false;
            var swipeDirection;
            var touchAlpha = 0.5;
            var touchAlphaChange = -0.1;
            var cX =0;
            var cY =0;
            var pX =0;
            var pY =0;

            var matrixWidth = 10;
            var userState = 'ready'




            widthText = game.config.width/matrixWidth;
            heightText = widthText
            
            


            function initScene() { }

            function preloadScene() {
                this.load.image("plane", "plane.png");
            }

            function createScene() {

                //set up matrix
          


                var textConfig={fontSize:widthText,color:'#555555',fontFamily: 'monospace'};
            



                // text example from https://phasergames.com/phaser-3-basics-images-text-and-click/
                // var textConfig={fontSize:'20px',color:'#555555',fontFamily: 'Arial'};
                // var textConfig={fontSize:fontSizePx,color:'#555555',font: '20px monospace'};

                //var textConfig={fontSize:fontSize,color:'#555555',font: fontSizePx};
                


                var w0 = this.add.text(0, widthText*6, "123456789012345678",textConfig);
                var let0 = this.add.text(widthText, heightText, "A",textConfig);
                var let00 = this.add.text(widthText*8, heightText, "H",textConfig);
                
                var let8 = this.add.text(widthText*1.2, (heightText*8)-(heightText*0.1), "A",textConfig);
                var let88 = this.add.text(widthText*8, heightText*8, "H",textConfig);
                
                var let1 = this.add.text(widthText, heightText*6, "A",textConfig);
                var let2 = this.add.text(widthText*2, heightText*6, "B",textConfig);
                var let2 = this.add.text(widthText*8, heightText*6, "H",textConfig);
                var word1 = this.add.text((widthText)+(widthText*0.2), (heightText*7)-(heightText*0.1), "q",textConfig);
                var word2 = this.add.text((widthText*2)+(widthText*0.2), (heightText*7)-(heightText*0.1), "w",textConfig);
                var word2 = this.add.text((widthText*3)+(widthText*0.2), (heightText*7)-(heightText*0.1), "e",textConfig);
                var word2 = this.add.text((widthText*4)+(widthText*0.2), (heightText*7)-(heightText*0.1), "r",textConfig);
                var word2 = this.add.text((widthText*5)+(widthText*0.2), (heightText*7)-(heightText*0.1), "t",textConfig);
                var word2 = this.add.text((widthText*6)+(widthText*0.2), (heightText*7)-(heightText*0.1), "y",textConfig);
                var word2 = this.add.text((widthText*7)+(widthText*0.2), (heightText*7)-(heightText*0.1), "u",textConfig);
                var word2 = this.add.text((widthText*8)+(widthText*0.2), (heightText*7)-(heightText*0.1), "p",textConfig);

                //
                w2 = this.add.text(widthText, widthText*11, "A",textConfig);    
                this.add.text(widthText*4, widthText*6, "C",textConfig);
                

                //w1.setOrigin(0,0);
                //w2.setOrigin(0.5,0.5);
                //w2.setOrigin(0.5,0.5);
                //w0.setOrigin(0.5,0.5);
                //this.setOrigin (0.5,0.5);
                //let00.setOrigin(0.5,0.5);

                // this.title=this.add.text(game.config.width/2,game.config.height*.75,"Hello Wordga!!!",textConfig);
                aTaskBar = this.add.text(0,0,"01234567890123456789",textConfig);
             
                //line1 = new Phaser.Line(100, 100,100, 100);
                
                console.log("********")
                console.log(widthText, heightText)

                const landscape = this.add.graphics();

                //landscape.fillStyle(0x000000, 1);
                landscape.lineStyle(1, 0xFFFFFF, 1);


                //landscape.moveTo(widthText, heightText);
                //landscape.lineTo(widthText*9, heightText);

                
                var currentHeighText = 1 

                for (let i =1; i<=9 ; i++)
                {
                    landscape.moveTo(widthText, heightText*i);
                    landscape.lineTo(widthText*9, heightText*i);
                }

                for (let i =1; i<=9 ; i++)
                {
                    landscape.moveTo(widthText*i, heightText);
                    landscape.lineTo(widthText*i, heightText*9);
                }



                //landscape.moveTo(100, 100);
                //landscape.lineTo(150, 150);
                landscape.strokePath();



                //GR.LINE n,wt, ht* cyid, wt*9, ht * cyid


/*
                GR.LINE n,wt, ht, wt*9, ht
                GR.LINE n,wt, ht, wt, ht*8
                GR.LINE n,wt*9, ht, wt*9, ht*8
*/
                
                plane = this.add.sprite(640, 360, "plane");
                plane.setScale(0.4);


            }

            //function updateScene() { }
            /* option 1 direct */
            function updateScene() {

                if(!this.input.activePointer.isDown && isClicking == true) {
                    plane.x = this.input.activePointer.position.x;
                    plane.y = this.input.activePointer.position.y;
                    isClicking = false;

                    console.log("---Position---");
                    console.log(this.input.activePointer.position.x);  
                    console.log(this.input.activePointer.position.y);   

                    plane.alpha = 1.0;

                    pX = cX;
                    pY = cY;    
                    cX = parseInt(this.input.activePointer.position.x/game.config.width*matrixWidth);
                    cY = parseInt(this.input.activePointer.position.y/game.config.width*matrixWidth);

                    getUserState()

                } else if(this.input.activePointer.isDown && isClicking == false) {
                    isClicking = true;
                }

                if(plane.alpha<=0.1) {
                    touchAlphaChange = 0.01;
                } else if (plane.alpha>=0.9) {
                    touchAlphaChange = -0.01;
                }

             plane.alpha += touchAlphaChange;

             w2.setText(cX+" "+cY+" "+pX+" "+pY);



            }

            function getUserState() {
            //    function placeWord() {
            
                console.log("User state logged")

			var x1 = pX;
			var y1 = pY;
			var x2 = cX;
			var y2 = cY;




			console.log("---old position----");
			console.log(x1);
			console.log(y1);
			console.log("---new position----");
			console.log(x2);
			console.log(y2);
			console.log("-------");

			var xShift = 0;
			var yShift = 0;

			if (x1 == x2) {
				//console.log ("must be verticle");

				if (y1 == y2) {
					console.log("no direction indicated");
				}
				else if (y1 < y2) {
					console.log("verticle down");
					yShift = 1;
				}
				else if (y1 > y2) {
					console.log("verticle up");
					yShift = -1;
				}
				else {
					console.log("error!");
				}

			}
            else if (y1 == y2) {
                if (x1 < x2) {
				console.log("horizontal right");
				xShift = 1;
                }
                else if (x1 > x2) {
                    console.log("horizontal left");
                    xShift = -1;
                }
                else {
                    console.log("no direction");
                }


            }

            if (userState == 'ready') {
                userState = 'anchor'

            }
            else if (userState =='anchor') {
                if (xShift + xShift ==0) {
                    userState = 'ready'
                }
                else {
                    userState = 'place'
                }

            }


            console.log(userState);

            }
/*
    function drawMatrix ()
    {
        GR.LINE n,wt, ht, wt*9, ht
        GR.LINE n,wt, ht, wt, ht*8
        GR.LINE n,wt*9, ht, wt*9, ht*8
    }
    */

        </script>
    </body>
</html>
